# Walmart-Recruiting---Store-Sales-Forecasting

## პროექტის აღწერა
ამოცანა არის Walmart-ის რამდენიმე მაღაზიისა და განყოფილების ყოველკვირეული გაყიდვების პროგნოზირება 2010-2012 წლების მონაცემების გამოყენებით. შეფასების მეტრიკაა Weighted Mean Absolute Error, სადაც სადღესასწაულო კვირების წონა 5-ჯერ უფრო მაღალია, ვიდრე არასადღესასწაულო კვირების. 

## ჩვენი მიდგომა
1) Data exploration - შევისწავლეთ გაყიდვების კანონზომიერებები, სეზონურობა და დღესასწაულების გავლენა.
2) Feature Engineering - შესაბამისი არქიტექტურებისთვის დავამატეთ ახალი feature-ები, როგორიცაა lag features, სეზონურობის ინდიკატორები და ა.შ.
3) მოდელის არქიტექტურები - გამოვიყენეთ კლასიკური time-based მოდელები (arima, sarima, sarimax, prophet), tree-based მოდელები (lightgbm, xgboost) და deep learning მოდელები ().
4) MLflow ინტეგრაცია - ექსპერიმენტების ტრეკინგისთვის გამოვიყენეთ MLflow.

## რეპოზიტორიის სტრუქტურა



```text
Walmart-Recruiting---Store-Sales-Forecasting/
│
├── 📊 data_exploration.ipynb          # (მონაცემების ანალიზი)
│
├── 🤖 model_experiment_xgboost.ipynb  # XGBoost model training
│
├── 🤖 model_experiment_x.ipynb...     # სხვა მოდელები
│
├── 🚀 model_inference.ipynb           # მოდელის ჩამოლოადება და submission ფაილის გამზადება
│
└── 📝 README.md                       # Project documentation

```

## data exploration ძირითადი დასკვნები

1) ყოველკვირეული გაყიდვები აშკარა სეზონურ რყევებს განიცდის, მაგრამ გრძელვადიანი ტენდენცია არ ჩანს 2.5-წლიან პერიოდში. ეს მიუთითებს მონაცემების სტაციონარულობაზე, რაც time series მოდელირებისთვის ხელსაყრელია.
2) ყველაზე მნიშვნელოვანი გაყიდვების პიკი შობასთან არის დაკავშირებული. დღესასწაულების კვირებში გაყიდვების განაწილება მკვეთრად განსხვავდება ჩვეულებრივი კვირებისგან. ამიტომ შობის ეფექტი შეიძლება იყოს რეგრესორი time-series მოდელებში.
3) დეპარტამენტები სხვადასხვა მაღაზიებში მსგავს შედეგებს დებენ უმეტესად,, რაც მიუთითებს, რომ მომხმარებლების ქცევაზე უფრო დროითი ფაქტორები (სეზონი, დღესასწაულები) მოქმედებს, ვიდრე კონკრეტული მაღაზიის მახასიათებლები.
4) ავტოკორელაციის ანალიზი აჩვენებს ძლიერ მოკლევადიან დამოკიდებულებებს (1-4 კვირა) და წლიურ სეზონურობას (52 კვირა). ეს ნიშნავს, რომ უახლოესი გაყიდვების ისტორია მნიშვნელოვანია მომავალი პროგნოზირებისთვის. ამიტომ ხეებში ხელსაყრელი იქნება ლეგ ფიჩერები: 1, 2, 3, 4 და 52 კვირის ლეგები პროგნოზირებისთვის.

## მოდელები

### tree_based models (xgboost, lightgbm)

#### Data_cleaning
გვაქვს MissingMarkdownHandler, რომელიც მარკდაუნის Nan-ებს ჩაანაცვლებს 0-ებით. რეალურად რაც ნალი იყო, ის არ ნიშნავდა მარკდაუნის ნულობას, არამედ - ინფორმაციის არ ქონას ნიშნავს. ამიტომ დავამტეთ boolean ფლეგი, ახალი სვეტები, რომ 0-ობა და ინფორმაციის არ ქონა განგვესხვავებინა ერთმანეთისგან. ხოლო თვითონ ნანები ორნაირად ჩავანაცვლეთ- 0ებით და მედიანათი, შედეგები არ იყო დიდად განსხვავებული. ჩავთვალეთ, რომ რადგან მედიანათი შევსება მოდელს იმ დაშvებას გააკეთებინებს, რომ ეს მარკდაუნები ერთმანეთზე არიან დამოკიდებული. ამიტომ აჯობა 0-ებმა ოდნავ მედიანათი შევსების სტრატეგიას. ხოლო სხვა fetureb-ში თუ შეხვდა Nan, ვიყენებთ forward-fill (ffill) და backward-fill (bfill), ანუ წინა კვირის ინფორმაციას გამოიყენებს.

### feature_engineering 
Tree-based models სჭირდებათ  seasonal სვეტები, რადგან ისინი ბუნებრივად ვერ იჭერენ ციკლურ პატერნებს, როგორც time-series მოდელები, ამიტომაც შევქმენით DateFeatureExtractor კლასი, რომელიც ამატებს ახალ featureb-ს. 
1) ვაფიქსირებთ დღესასწაულების წინა და შემდეგ პერიოდებსა(მაგ., days_until_christmas < 7  ---> ბოლო წუთის shopping)
2) Year, Month, Week, Day, DayOfWeek-ის დავამატეთ, რადგან ხეებს სჭირდებათ ზუსტი, გამოყოფილი featurebი. 
3) გამოვიყენეთ Cyclic encoding მიდგომა, დავამატეთ Month_sin, Month_cos, Week_sin, Week_cos, რათა აღქმული იყოს რომ მე-12 თვის შემდეგ 1-ლი მოდის, ანუ ციკლურობის შესანარჩუნებლად. 
4) Total_MarkDown: markdown-ების მთლიანი რაოდენობა
5) MarkDown_Intensity: ნორმალიზებული markdown მნიშვნელობა
6) Economic_Index: CPI-ისა და Unemployment-ის ერთიან  score-ად გაერთიანება
7) დავამატეთ lag-ებიც თითოეული (store, department) წყვილისთვის თავისი სპეციპიკური lag_1, lag_4, lag_52 ანუ 1 კვირის, 1 თვის და 1 წლის წინანდელი weekly_sales სვეტები. ეს სამივე დავამატეთ რადგან გავითვალისწინეთ რომ (store, department) წყვილებს სხვადასხვა “პატერნი” შეიძლება ჰქონდეთ. თავიდან არ გვქონდა ეს ახალი სვეტები, როცა დავამატეთ ჩვენმა მოდელმა უკეთესი შედეგი დადო.



